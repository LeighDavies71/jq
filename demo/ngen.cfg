
.tempdir _temp
.outdir _out

.config debug
.config release


.config nomicroprofile 	release

.config asan 			release			osx linux
.config ubsan 			release			osx linux
.config threadsan 		release			osx linux
.config memsan 			release			osx linux


includepath 			.
includepath 			..
includepath 			../microprofile



cflags 					-DJQ_ASSERT_LOCKS
cflags 					-DMICROPROFILE_MAX_THREADS=128
cflags 					-DMICROPROFILE_GPU_TIMERS=0

cflags 					-DJQ_MICROPROFILE
cflags 					-DJQ_MICROPROFILE_VERBOSE
cflags.nomicroprofile	-DMICROPROFILE_ENABLED=0

cflags.asan 			-fsanitize=address
ldflags.asan 			-fsanitize=address

cflags.threadsan 		-fsanitize=thread
ldflags.threadsan 		-fsanitize=thread

cflags.ubsan 			-fsanitize=undefined
ldflags.ubsan 			-fsanitize=undefined

cflags.memsan 			-fsanitize=memory
cflags.memsan 			-fsanitize-memory-track-origins=2 -fno-omit-frame-pointer
ldflags.memsan 			-fsanitize=memory


.ngen.osx				ngen.osx
.ngen.linux				ngen.linux
.ngen.win32 			ngen.win32


.file ../jq2.cpp
.file ../jqinternal.cpp
.file ../microprofile/microprofile.cpp


.file.linux 	../boost_context/jump_x86_64_sysv_elf_gas.S
.file.linux  	../boost_context/make_x86_64_sysv_elf_gas.S

.file.osx 		../boost_context/jump_x86_64_sysv_macho_gas.S
.file.osx 		../boost_context/make_x86_64_sysv_macho_gas.S


.target demo_simple
	.file demo_simple.cpp
.end

.target demo_full
	.file demo_full.cpp
.end

.target demo_profile
	.file demo_profile.cpp
.end

